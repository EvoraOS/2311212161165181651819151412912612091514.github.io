<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Customize Wallpaper</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      height: 100vh;
      overflow: hidden;
      background-color: rgba(50, 50, 50, 0.5);
    }
    
    /* Top navigation bar - more compact */
    .top-nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      display: flex;
      justify-content: space-between;
      padding: 10px 15px;
      z-index: 10;
    }
    
    .nav-button {
      background: none;
      border: none;
      color: white;
      font-size: 16px;
      font-weight: 500;
      padding: 8px 20px;
      border-radius: 999px;
      cursor: pointer;
    }
    
    #cancel-btn {
      background: rgba(255, 255, 255, 0.3);
    }
    
    #save-btn {
      background: #000;
    }
    
    /* Background blur container */
    .blur-container {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      overflow: hidden;
    }
    
    .blur-bg {
      position: absolute;
      top: -20px;
      left: -20px;
      right: -20px;
      bottom: -20px;
      background-position: center;
      background-size: cover;
      filter: blur(100px);
    }
    
    /* Wallpaper container - adjusted to be more similar to image */
    .wallpaper-container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 70%;
      height: 75%;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
    }
    
    .wallpaper {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 20px;
    }
    
    /* Text overlay - adjusted positioning and sizes */
    .text-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }
    
    #main-text {
      font-size: 72px;
      font-weight: 800;
      letter-spacing: 2px;
      line-height: 1.2;
      text-align: center;
      margin-bottom: 100px;
    }
    
    .text-subtitle {
      font-size: 28px;
      font-weight: 600;
      text-align: center;
      line-height: 1.2;
    }
    
    /* Text editor modal */
    .text-editor {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80%;
      background: rgba(40, 40, 40, 0.9);
      border-radius: 16px;
      padding: 20px;
      z-index: 20;
      display: none;
    }
    
    .text-editor input, .text-editor textarea {
      width: 100%;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      color: white;
      padding: 10px;
      margin-bottom: 15px;
      font-size: 16px;
    }
    
    .text-editor button {
      background: #000;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
    }
    
    /* Bottom toolbar - more compact */
    .bottom-toolbar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      display: flex;
      justify-content: space-around;
      padding: 10px;
      background: rgba(40, 40, 40, 0.7);
      backdrop-filter: blur(10px);
      z-index: 10;
    }
    
    .tool-button {
      display: flex;
      flex-direction: column;
      align-items: center;
      color: white;
      text-decoration: none;
      width: 60px;
    }
    
    .tool-icon {
      width: 40px;
      height: 40px;
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 5px;
    }
    
    .tool-text {
      font-size: 12px;
      text-align: center;
    }
  </style>
</head>
<body>
  <!-- Top navigation -->
  <div class="top-nav">
    <a href="2.html" class="nav-button" id="cancel-btn">Cancel</a>
    <button class="nav-button" id="save-btn">Save</button>
  </div>
  
  <!-- Background blur -->
  <div class="blur-container">
    <div class="blur-bg" id="blur-background"></div>
  </div>
  
  <!-- Wallpaper container -->
  <div class="wallpaper-container">
    <img src="" id="selected-wallpaper" class="wallpaper" alt="Selected Wallpaper">
    <div class="text-overlay" id="text-content">
      <div id="main-text">EVO</div>
      <div class="text-subtitle" id="subtitle-text">The Best Of<br>Evora</div>
    </div>
  </div>
  
  <!-- Text editor modal -->
  <div class="text-editor" id="text-editor">
    <input type="text" id="main-text-input" placeholder="Main Text" value="EVO">
    <textarea id="subtitle-text-input" placeholder="Subtitle Text">The Best Of
Evora</textarea>
    <button id="apply-text-btn">Apply</button>
  </div>
  
  <!-- Bottom toolbar -->
  <div class="bottom-toolbar">
    <a href="#" class="tool-button" id="text-btn">
      <div class="tool-icon">
        <span style="font-size: 20px; font-weight: bold;">Tt</span>
      </div>
      <span class="tool-text">Add Text</span>
    </a>
    
    <a href="#" class="tool-button" id="size-btn">
      <div class="tool-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
        </svg>
      </div>
      <span class="tool-text">Size</span>
    </a>
    
    <a href="#" class="tool-button" id="stickers-btn">
      <div class="tool-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
        </svg>
      </div>
      <span class="tool-text">Stickers</span>
    </a>
  </div>
  
  <script>
    // Function to get URL parameters
    function getUrlParameter(name) {
      name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
      var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
      var results = regex.exec(location.search);
      return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    }
    
    // Set the wallpaper based on URL parameter
    document.addEventListener('DOMContentLoaded', function() {
      // Get the wallpaper from URL parameter or use default
      var wallpaper = getUrlParameter('wallpaper') || 'wall1.jpg';
      
      // Set the wallpaper and background
      document.getElementById('selected-wallpaper').src = wallpaper;
      document.getElementById('blur-background').style.backgroundImage = 'url(' + wallpaper + ')';
      
      // Show text by default to match the example image
      document.getElementById('text-content').style.display = 'flex';
      
      // Initialize tool buttons
      document.getElementById('text-btn').addEventListener('click', function(e) {
        e.preventDefault();
        openTextEditor();
      });
      
      document.getElementById('size-btn').addEventListener('click', function(e) {
        e.preventDefault();
        // Size functionality will be added later
        alert('Size adjustment feature coming soon!');
      });
      
      document.getElementById('stickers-btn').addEventListener('click', function(e) {
        e.preventDefault();
        // Stickers functionality will be added later
        alert('Stickers feature coming soon!');
      });
      
      // Apply text button
      document.getElementById('apply-text-btn').addEventListener('click', function() {
        applyTextChanges();
      });
      
      // Save button functionality
      document.getElementById('save-btn').addEventListener('click', function() {
        // Create a canvas to combine the wallpaper and text
        var wallpaperImg = document.getElementById('selected-wallpaper');
        
        // Wait for image to load
        if (wallpaperImg.complete) {
          downloadWallpaper(wallpaperImg);
        } else {
          wallpaperImg.onload = function() {
            downloadWallpaper(wallpaperImg);
          };
        }
      });
    });
    
    // Open text editor with current values
    function openTextEditor() {
      var mainText = document.getElementById('main-text').textContent;
      var subtitleText = document.getElementById('subtitle-text').innerHTML.replace(/<br>/g, '\n');
      
      document.getElementById('main-text-input').value = mainText;
      document.getElementById('subtitle-text-input').value = subtitleText;
      document.getElementById('text-editor').style.display = 'block';
    }
    
    // Apply text changes from editor
    function applyTextChanges() {
      var mainText = document.getElementById('main-text-input').value;
      var subtitleText = document.getElementById('subtitle-text-input').value.replace(/\n/g, '<br>');
      
      document.getElementById('main-text').textContent = mainText;
      document.getElementById('subtitle-text').innerHTML = subtitleText;
      document.getElementById('text-editor').style.display = 'none';
    }
    
    // Function to download the edited wallpaper
    function downloadWallpaper(img) {
      // Create canvas
      var canvas = document.createElement('canvas');
      canvas.width = img.naturalWidth;
      canvas.height = img.naturalHeight;
      
      // Draw image on canvas
      var ctx = canvas.getContext('2d');
      ctx.drawImage(img, 0, 0);
      
      // If text is visible, draw it on canvas
      var textContent = document.getElementById('text-content');
      if (textContent.style.display !== 'none') {
        // Set text styles for main text
        ctx.font = 'bold 72px Arial';
        ctx.fillStyle = 'white';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
        ctx.shadowBlur = 10;
        ctx.shadowOffsetX = 2;
        ctx.shadowOffsetY = 2;
        
        // Draw main text
        var mainText = document.getElementById('main-text').textContent;
        ctx.fillText(mainText, canvas.width / 2, canvas.height / 2 - 80);
        
        // Draw subtitle
        ctx.font = 'bold 28px Arial';
        var subtitleLines = document.getElementById('subtitle-text').innerHTML.split('<br>');
        var lineHeight = 40;
        var startY = canvas.height / 2 + 80;
        
        subtitleLines.forEach(function(line, index) {
          ctx.fillText(line.trim(), canvas.width / 2, startY + (index * lineHeight));
        });
      }
      
      // Create download link
      var link = document.createElement('a');
      link.download = 'customized-wallpaper.jpg';
      link.href = canvas.toDataURL('image/jpeg', 0.9);
      link.click();
    }
  </script>
</body>
</html>
