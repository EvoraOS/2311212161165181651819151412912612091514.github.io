<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Customize Wallpaper</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      height: 100vh;
      overflow: hidden;
      background-color: rgba(50, 50, 50, 0.5);
    }
    
    /* Top navigation bar */
    .top-nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      display: flex;
      justify-content: space-between;
      padding: 16px;
      z-index: 10;
    }
    
    .nav-button {
      background: none;
      border: none;
      color: white;
      font-size: 18px;
      font-weight: 500;
      padding: 8px 24px;
      border-radius: 999px;
      cursor: pointer;
    }
    
    #cancel-btn {
      background: rgba(255, 255, 255, 0.3);
    }
    
    #save-btn {
      background: #000;
    }
    
    /* Background blur container */
    .blur-container {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      overflow: hidden;
    }
    
    .blur-bg {
      position: absolute;
      top: -20px;
      left: -20px;
      right: -20px;
      bottom: -20px;
      background-position: center;
      background-size: cover;
      filter: blur(100px);
    }
    
    /* Wallpaper container */
    .wallpaper-container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80%;
      height: 70%;
      border-radius: 20px;
      overflow: hidden;
    }
    
    .wallpaper {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 20px;
    }
    
    /* Text overlay for demonstration */
    .text-overlay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 36px;
      font-weight: bold;
      text-align: center;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }
    
    .text-subtitle {
      margin-top: 20px;
      font-size: 24px;
    }
    
    /* Bottom toolbar */
    .bottom-toolbar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      display: flex;
      justify-content: space-around;
      padding: 16px;
      background: rgba(50, 50, 50, 0.5);
      z-index: 10;
    }
    
    .tool-button {
      display: flex;
      flex-direction: column;
      align-items: center;
      color: white;
      text-decoration: none;
      width: 70px;
    }
    
    .tool-icon {
      width: 50px;
      height: 50px;
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 8px;
    }
    
    .tool-text {
      font-size: 14px;
      text-align: center;
    }
  </style>
</head>
<body>
  <!-- Top navigation -->
  <div class="top-nav">
    <a href="index.html" class="nav-button" id="cancel-btn">Cancel</a>
    <button class="nav-button" id="save-btn">Save</button>
  </div>
  
  <!-- Background blur -->
  <div class="blur-container">
    <div class="blur-bg" id="blur-background"></div>
  </div>
  
  <!-- Wallpaper container -->
  <div class="wallpaper-container">
    <img src="" id="selected-wallpaper" class="wallpaper" alt="Selected Wallpaper">
    <div class="text-overlay" id="text-content" style="display: none;">
      <div id="main-text">EVO</div>
      <div class="text-subtitle" id="subtitle-text">The Best Of<br>Evora</div>
    </div>
  </div>
  
  <!-- Bottom toolbar -->
  <div class="bottom-toolbar">
    <a href="#" class="tool-button" id="text-btn">
      <div class="tool-icon">
        <span style="font-size: 24px; font-weight: bold;">Tt</span>
      </div>
      <span class="tool-text">Add Text</span>
    </a>
    
    <a href="#" class="tool-button" id="size-btn">
      <div class="tool-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
        </svg>
      </div>
      <span class="tool-text">Size</span>
    </a>
    
    <a href="#" class="tool-button" id="stickers-btn">
      <div class="tool-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
        </svg>
      </div>
      <span class="tool-text">Stickers</span>
    </a>
  </div>
  
  <script>
    // Function to get URL parameters
    function getUrlParameter(name) {
      name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
      var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
      var results = regex.exec(location.search);
      return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    }
    
    // Set the wallpaper based on URL parameter
    document.addEventListener('DOMContentLoaded', function() {
      // Get the wallpaper from URL parameter or use default
      var wallpaper = getUrlParameter('wallpaper') || 'wall1.jpg';
      
      // Set the wallpaper and background
      document.getElementById('selected-wallpaper').src = wallpaper;
      document.getElementById('blur-background').style.backgroundImage = 'url(' + wallpaper + ')';
      
      // Initialize tool buttons
      document.getElementById('text-btn').addEventListener('click', function(e) {
        e.preventDefault();
        toggleTextEditor();
      });
      
      document.getElementById('size-btn').addEventListener('click', function(e) {
        e.preventDefault();
        // Size functionality will be added later
        alert('Size adjustment feature coming soon!');
      });
      
      document.getElementById('stickers-btn').addEventListener('click', function(e) {
        e.preventDefault();
        // Stickers functionality will be added later
        alert('Stickers feature coming soon!');
      });
      
      // Save button functionality
      document.getElementById('save-btn').addEventListener('click', function() {
        // Create a canvas to combine the wallpaper and text
        var canvas = document.createElement('canvas');
        var wallpaperImg = document.getElementById('selected-wallpaper');
        
        // Wait for image to load
        if (wallpaperImg.complete) {
          downloadWallpaper(wallpaperImg);
        } else {
          wallpaperImg.onload = function() {
            downloadWallpaper(wallpaperImg);
          };
        }
      });
    });
    
    // Toggle text editor
    function toggleTextEditor() {
      var textContent = document.getElementById('text-content');
      textContent.style.display = textContent.style.display === 'none' ? 'block' : 'none';
    }
    
    // Function to download the edited wallpaper
    function downloadWallpaper(img) {
      // Create canvas
      var canvas = document.createElement('canvas');
      canvas.width = img.naturalWidth;
      canvas.height = img.naturalHeight;
      
      // Draw image on canvas
      var ctx = canvas.getContext('2d');
      ctx.drawImage(img, 0, 0);
      
      // If text is visible, draw it on canvas
      var textContent = document.getElementById('text-content');
      if (textContent.style.display !== 'none') {
        // Set text styles
        ctx.font = 'bold 72px Arial';
        ctx.fillStyle = 'white';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
        ctx.shadowBlur = 10;
        ctx.shadowOffsetX = 2;
        ctx.shadowOffsetY = 2;
        
        // Draw main text
        ctx.fillText('EVO', canvas.width / 2, canvas.height / 2 - 40);
        
        // Draw subtitle
        ctx.font = 'bold 36px Arial';
        ctx.fillText('The Best Of', canvas.width / 2, canvas.height / 2 + 30);
        ctx.fillText('Evora', canvas.width / 2, canvas.height / 2 + 80);
      }
      
      // Create download link
      var link = document.createElement('a');
      link.download = 'customized-wallpaper.jpg';
      link.href = canvas.toDataURL('image/jpeg', 0.9);
      link.click();
    }
  </script>
</body>
</html>
